<% if (initial) { %>
	<!-- Initial Page things that only get loaded when the page is first loaded -->
	<div class="flex-row">
		<h1 class="text-4xl"><%= ownerName %>'s Game</h1>
		<button onclick="addAIPlayer()" class="invite-btn bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded">Add AI</button>
		<button onclick="addLocalPlayer()" class="invite-btn bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded">Add Local Player</button>
		<button onclick="startGame()" class="glow-blue py-2 px-4 rounded text-2xl"><%= t('lobby_admin.start_game') %></button>
		<input type="checkbox" name="Power-Ups enabled?" id="powerups-toggle">Power-Ups enabled?</input>
		<input type="number" name="Difficulty" id="difficulty-input" min="1" max="10" value="5">Game Difficulty</input>
		<label for="map-select">Map:</label>
		<select name="Map" id="map-select">
			<% if (availableMaps && availableMaps.length > 0) { %>
				<% for (const map of availableMaps) { %>
					<option value="<%= map %>"><%= map %></option>
				<% } %>
			<% } else { %>
				<option value="">No maps available</option>
			<% } %>
		</select>
		<label for="game-type-select">Game Type:</label>
		<select name="Game Type" id="game-type-select">
			<option value="classic">Classic / FFA</option>
			<option value="tournament">Tournament</option>
		</select>
		<br>
		<div>
			<h2>Online Friends:</h2>
			<p>Click on a friend to invite them to your game.</p>
			<div id="onlineFriendsList" class="flex">
				<!--Online friends will be inserted here-->
			</div>
			<button onclick="refreshOnlineFriends()">Refresh</button>
		</div>
		<br>
		<div id="lobby">
<% } %>
		<p>Players: <%= players.length %> / <span class="glow-red"><%= gameSettings.maxPlayers %></span></p>
		<div class="settings">
			<h2 class="text-3xl">Lobby Settings</h2>
			<div id="lobbySettings">
				<h3 class="text-2xl">Power-ups:</h3>
				<% if (gameSettings.powerupsEnabled) { %>
					<button onclick="addPowerUp()">Add Power Up</button>
					<% for (const powerup of gameSettings.powerups) { %>
						<div class="powerup">
							<span class="powerup-name"><%= powerup.name %></span>
							<span class="powerup-description"><%= powerup.description %></span>
							<button onclick="removePowerup()" class="invite-btn bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded">Remove</button>
						</div>
					<% } %>
				<% } else { %>
					<p>Power-ups are disabled.</p>
				<% } %>
			</div>
		</div>
		<br>
		<br>
		<% if (gameSettings.gameType === 'classic') { %>
		<div class="players">
			<h2 class="text-3xl">Players:</h2>
			<div id="playerList">
				<% if (!players || players.length === 0) { %>
					<p>No players joined.</p>
				<% } else { %>
					<% for (const player of players) { %>
						<div class="<%= player.joined ? 'border-green-500' : 'border-red-500' %>">
							<h3 class="glow-green"><%= player.displayName || 'Unknown Player' %></h3>
							<h3 class="glow-red"><%= player.playerTitle || 'Unknown Title' %></h3>
							<h3 class="glow-blue"><%= player.joined ? "Joined" : "Not Joined" %></h3>
							<h3 class="glow-purple">Type: <%= player.type || 'Unknown' %></h3>
							<% if (player.playerId !== 0) { %> <!-- 0 is the admin -->
								<button onclick="kickPlayer(<%= player.playerId %>)" class="invite-btn bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded">Remove</button>
							<% } %>
						</div>
					<% } %>
				<% } %>
			</div>
		</div>
		<% } else { %>
			<h2 class="text-3xl mb-4">Tournament Tree</h2>
				<div class="flex flex-row gap-16 justify-center items-start">
				<!-- Quarterfinals: 4 matches (8 players) -->
				<div class="flex flex-col gap-12 justify-center items-center">
					<% for (let i = 0; i < 8; i += 2) { %>
					<div class="bg-blue-500 rounded-lg p-4 min-w-[160px] flex flex-col items-center shadow">
						<div class="font-bold text-white"><%= players[i]?.displayName || 'Waiting...' %></div>
						<div class="text-xs text-gray-200 mb-2"><%= players[i]?.playerTitle || '' %></div>
						<div class="font-bold text-white"><%= players[i+1]?.displayName || 'Waiting...' %></div>
						<div class="text-xs text-gray-200"><%= players[i+1]?.playerTitle || '' %></div>
					</div>
					<% } %>
				</div>
				<!-- Semifinals: 2 matches (4 players) -->
				<div class="flex flex-col justify-center items-center gap-32 mt-16">
					<% for (let i = 0; i < 4; i += 2) { %>
					<div class="bg-blue-700 rounded-lg p-4 min-w-[160px] flex flex-col items-center shadow">
						<div class="font-bold text-white">Winner QF <%= i/2 + 1 %></div>
						<div class="font-bold text-white mt-2">Winner QF <%= i/2 + 2 %></div>
					</div>
					<% } %>
				</div>
				<!-- Final: 1 match (2 players) -->
				<div class="flex flex-col justify-center items-center mt-40">
					<div class="bg-yellow-400 rounded-lg p-4 min-w-[160px] flex flex-col items-center shadow">
					<div class="font-bold text-black">Winner SF 1</div>
					<div class="font-bold text-black mt-2">Winner SF 2</div>
					</div>
				</div>
			</div>
		<% } %>
<% if (initial) { %>
		</div> <!-- End of lobby div -->
	</div> <!-- End of page div -->
	<!-- Initial Page things that only get loaded when the page is first loaded -->
	<button onclick="leaveGame()">Leave Game</button> 
	<script type="module" src="/static/js/lobby_admin.js" defer></script>
<% } %>