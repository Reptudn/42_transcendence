<% if (initial) { %>
	<div class="page-container">
		<div class="header flex-row justify-between items-center">
			<h1 class="text-5xl font-bold mt-10 mb-5"><%= ownerName %>'s Game</h1>
			<div class="actions flex gap-4 mb-5">
				<button onclick="addAIPlayer()" class="bg-blue-500 px-2 py-2 rounded">Add AI</button>
				<button onclick="addLocalPlayer()" class="bg-blue-500 px-2 py-2 rounded">Add Local Player</button>
				<button onclick="startGame()" class="bg-green-500 px-2 py-2 rounded"><%= t('game_setup.start_game') %></button>
				<button onclick="leaveGame()" class="bg-red-500 px-2 py-2 rounded">Leave Game</button>
			</div>
		</div>
		<div class="settings-section">
			<div class="form-group">
				<label for="powerups-toggle" class="form-label">Power-Ups enabled?</label>
				<input type="checkbox" name="Power-Ups enabled?" id="powerups-toggle" class="form-input">
			</div>
			<div class="form-group">
				<label for="difficulty-input" class="form-label">Game Difficulty</label>
				<input type="number" name="Difficulty" id="difficulty-input" min="2" max="10" value="5" class="form-input">
			</div>
			<div class="form-group">
				<label for="map-select" class="form-label">Map:</label>
				<select name="Map" id="map-select" class="form-select">
					<% if (availableMaps && availableMaps.length > 0) { %>
						<% for (const map of availableMaps) { %>
							<option value="<%= map %>"><%= map %></option>
						<% } %>
					<% } else { %>
						<option value="">No maps available</option>
					<% } %>
				</select>
			</div>
		</div>
		<div class="friends-section">
			<h2 class="text-3xl font-semibold mt-5">Online Friends</h2>
			<p>Click on a friend to invite them to your game.</p>
			<div id="onlineFriendsList" class="friends-list flex gap-4">
				<!-- Online friends will be inserted here -->
			</div>
			<button onclick="refreshOnlineFriends()" class="bg-blue-500 px-2 py-2 rounded">Refresh</button>
		</div>
		<div id="lobby" class="lobby-section">
<% } %>
			<div class="players-info">
				<p>Players: <%= players.length %> / <span class="text-red-500 font-bold"><%= gameSettings.maxPlayers %></span></p>
			</div>
			<div class="settings">
				<h2 class="text-4xl font-semibold mt-5">Lobby Settings</h2>
				<div id="lobbySettings">
					<h3 class="text-3xl font-medium">Power-ups:</h3>
					<% if (gameSettings.powerupsEnabled) { %>
						<button onclick="addPowerUp()" class="bg-blue-500 px-2 py-2 rounded">Add Power Up</button>
						<% for (const powerup of gameSettings.powerups) { %>
							<div class="powerup flex items-center gap-4">
								<span class="powerup-name font-bold"><%= powerup.name %></span>
								<span class="powerup-description text-gray-500"><%= powerup.description %></span>
								<button onclick="removePowerup()" class="btn-danger">Remove</button>
							</div>
						<% } %>
					<% } else { %>
						<p class="">Power-ups are disabled.</p>
					<% } %>
				</div>
			</div>
			<div class="players">
				<h2 class="text-4xl font-semibold mt-5">Players:</h2>
				<div id="playerList" class="player-list flex flex-col gap-4"></div>
					<% if (!players || players.length === 0) { %>
						<p class="text-gray-500">No players joined.</p>
					<% } else { %>
						<% for (const player of players) { %>
							<div class="player-card border rounded p-4 mb-5 <%= player.joined ? 'border-green-500' : 'border-red-500' %>">
								<h3 class="text-white-500 font-bold"><%= player.displayName || 'Unknown Player' %></h3>
								<h3 class="text-white-500"><%= player.playerTitle || 'Unknown Title' %></h3>
								<h3 class="text-white-500"><%= player.joined ? "Joined" : "Not Joined" %></h3>
								<% if (player.playerId !== 1) { %> <!-- 1 is the admin -->
									<button onclick="kickPlayer(<%= player.playerId %>)" class="bg-red-500 px-1 py-1 rounded">Remove</button>
								<% } %>
							</div>
						<% } %>
					<% } %>
				</div>
			</div>
<% if (initial) { %>
		</div> <!-- End of lobby div -->
	</div> <!-- End of page-container -->
	<script type="module" src="/static/js/game_setup.js" defer></script>
<% } %>